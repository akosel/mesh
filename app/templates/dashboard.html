{% extends "base.html" %}

    {% block pageid %}dashboard{% endblock %}

    {% block content %}
    <div id='wrapper'>
    <div class='container' id='profileHeader'>
        <div class='media'>
            <a class="pull-left" href="#">
		<img id="propic" src={{ user.picture }} class="pic-100 media-object" alt="pumpkinstin"/>
            </a>
            <div class="media-body">
                <h4 id="name" class="media-heading">{{ user.name }}</h4>
            </div>
        </div>
    </div>
    
    <div class='container' id='rowContainer'>
        <div class='row'id='wrapper'>
            <div class='sidefiller'></div>
            <div class='row'>
            <div id='activityFeedContainer' class='col-md-8'>
                <h4>Activity Feed</h4>
                {% for item in user.feed|sort(attribute='timestamp',reverse=True) %}
                    {% if item.user != user %}
                    <div class='container'>
                        <div class='media'>
                            <a class='pull-left' href='#'>
                                <img class='pic-60 media-object' src={{ item.user.picture }}></img>
                            </a>
                            <div class='media-body'>
                                <h4 class='media-heading media-heading-bold'>{{ item.name }}</h4>
                                <p>{{item.message}}</p>
                                <br>
                                {% if item.goal %}
                                Check it out: <a href='{{ url_for('goals',goalid=item.goal.id)}}'>{{item.goal.name}}</a>                                 
                                {% elif item.brainstorm %}
                                Check it out: <a href='{{ url_for('brainstorms',bsid=item.brainstorm.id) }}'>{{item.brainstorm.title}}</a>
                                {% endif %}
                                <h5 class='activityFeedDate'>{{ item.timestamp.strftime('%B %d at %H:%M %p') }}</h5>
                            </div>
                        {% if item.feed_item_type == 'BrainstormRequest' %}
                            <div id={{item.type}} class='pull-right btn-container'>
                                <a href="{{ url_for('joinbrainstorm',bsid=item.brainstorm.id)}}">
                                    <button id={{ item.id }} class='menu-btn pull-right accept'>Accept</button>
                                </a>
                                <a href="{{ url_for('removebsfeeditem',bsid=item.brainstorm.id)}}">
                                    <button id={{ item.id }} class='menu-btn pull-right reject'>Reject</button>
                                </a>
                            </div>
                        {% elif item.feed_item_type == 'GoalRequest' %}
                            <div id={{item.type}} class='pull-right btn-container'>
                                <a href="{{ url_for('joingoal',goalid=item.goal.id)}}">
                                    <button id={{ item.id }} class='menu-btn pull-right accept'>Accept</button>
                                </a>
                                <a href="{{ url_for('newbrainstorm')}}">
                                    <button id={{ item.id }} class='menu-btn pull-right reject'>Brainstorm</button>
                                </a>
                                <a href="{{ url_for('removefeeditem',goalid=item.goal.id)}}">
                                    <button id={{ item.id }} class='menu-btn pull-right reject'>Reject</button>
                                </a>
                            </div> 
                        {% endif %}
                        </div>
                    </div>
                {% endif %}
                {% else %}
                    <h1>Nothing to report. Add a goal and find some friends to get started!</h1>
                
                {% endfor %}

            </div>
            <div id='toDoListContainer' class='col-md-4'>
                <h4>To Do</h4>

                <div id='toDoList'>
                    {% for task in todo %}
                        <div class='container' id= 'list-item'>
                            <div class='media'>
                                    <i class='fa-media-object fa fa-square-o fa-4x' id={{task.id}} label={{task.goalid}}></i>
                                <div class='media-body'>
                                     <h5 class='toDoDate'>{{ task.end|datetimeformat }}</h5>
                                    <h4 id={{task.id}} class='media-heading media-heading-bold'>{{task.name}}</h4>
                                </div>
                            </div>
                        </div>

                        {% else %} 
                        <a href="/newgoal">
                            <div class="goalsCreate">
                                <i class="fa fa-plus-circle"></i><p class="createLabel">Add a Goal</p>
                            </div>
                        </a>
                    {% endfor %}
                </div>     
            </div>
            </div>
        </div>
    </div> 
    {% endblock %}	
<script>
    $(document).on('click','#shareButton',function(){
       console.log($(this).prev().attr('label'));
       url = '/completetask/' + $(this).prev().attr('label') + '/' + $(this).prev().attr('id') + '/' + $(this).prev().val();
        $.get(url);
        //url = /goalid/taskid/comment
    })
$(document).on('click','button.notnow-btn',function(){
    console.log('click');
  //  $(this).parent().parent().parent().remove();
    url = '/completetask/' + $(this).prev().prev().attr('label') + '/' + $(this).prev().prev().attr('id');
    $.get(url);
})
</script>
</html>
